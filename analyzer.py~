# analyzer.py
import os
import json
import pandas as pd
import config


def load_data(date_str: str):
    """Wczytaj dane z pliku JSON do DataFrame"""
    file_path = os.path.join(config.data_path, f"{date_str}.json")
    if not os.path.exists(file_path):
        print(f"Brak pliku: {file_path}")
        return None

    with open(file_path, "r", encoding="utf-8") as f:
        data = json.load(f)

    df = pd.DataFrame.from_dict(data, orient='index')
    df = df.apply(pd.to_numeric, errors='ignore')  # konwertuj liczby
    return df


def top_by_volume(df, n=10):
    """Ranking TOP spółek wg wolumenu"""
    return df.sort_values(by="volume", ascending=False).head(n)


if __name__ == "__main__":
    date = "3-9-2025"  # przykład daty
    df = load_data(date)
    if df is not None:
        print(top_by_volume(df))
